<h1 class="text-center">Recepción de mercancía</h1>
<div *ngIf="authService.hasPermission('goodsreceipt-create')" class="text-center" style="padding: 15px">
    <a routerLink="nuevo" class="btn btn-sm btn-success mb-2">Crear albarán de recepción de mercancía</a>
</div>
<div id="search-report">
    <div>
        <input type="text" placeholder="Núm. doc., provedor, usuario..." #filter>
        <button class="primary" type="button" (click)="search(filter.value, $event)">
            <span *ngIf="isSearching" class="spinner-border spinner-border-sm"></span>
            <span *ngIf="!isSearching">Buscar</span>
        </button>
    </div>
    <button id="report-pdf" class="btn-secondary btn-sm mb-2" (click)="goodsreceiptToPDF()" [disabled]="isPrintingPDF">
        <span *ngIf="isPrintingPDF" class="spinner-border spinner-border-sm"></span>
        <span *ngIf="!isPrintingPDF">Descargar informe PDF</span></button>
</div>
<table *ngIf="authService.hasPermission('goodsreceipt-list')" class="table table-striped">
    <thead>
        <tr>
            <th></th>
            <th>Núm. docum.</th>
            <th>Proveedor</th>
            <th>Usuario</th>
            <th>Fecha</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let goodsreceipt of goodsreceipts">
            <td></td>
            <td>{{goodsreceipt.docnum}}</td>
            <td><span *ngIf="!goodsreceipt.supplierName" class="spinner-border spinner-border-sm"></span>
                {{goodsreceipt.supplierName}}</td>
            <td><span *ngIf="!goodsreceipt.userName" class="spinner-border spinner-border-sm"></span>
                {{goodsreceipt.userName}}</td>
            <td>{{goodsreceipt.date | date: 'dd/MM/yyyy'}}</td>
            <td>
                <a *ngIf="authService.hasPermission('goodsreceipt-edit')" routerLink="editar/{{goodsreceipt.id}}"
                    class="btn btn-sm btn-primary me-1">Ver/Editar</a>
                <button *ngIf="authService.hasPermission('goodsreceipt-delete')"
                    (click)="deleteProduct(goodsreceipt.docnum, goodsreceipt.id)"
                    class="btn btn-sm btn-danger btn-delete-user" [disabled]="goodsreceipt.isDeleting">
                    <span *ngIf="" class="spinner-border spinner-border-sm"></span>
                    <span *ngIf="!goodsreceipt.isDeleting">Eliminar</span>
                </button>
            </td>
        </tr>
        <tr *ngIf="!goodsreceipts">
            <td colspan="6" class="text-center">
                <span class="spinner-border spinner-border-md align-center"></span>
            </td>
        </tr>
    </tbody>
</table>
<nav>
    <ul class="pagination justify-content-center">
        <li class="page-item" *ngFor="let link of links">
            <a class="page-link {{link.active ? 'active' : ''}} {{link.url === null?'disabled':''}}" href="{{link.url}}"
                (click)="onChangePagination($event)">{{link.label}}</a>
        </li>
    </ul>
</nav>